
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="seafile">
      
      
        <link rel="canonical" href="https://haiwen.github.io/seafile-admin-docs/12.0/setup/cluster_deploy_with_k8s/">
      
      
        <link rel="prev" href="../cluster_deploy_with_docker/">
      
      
        <link rel="next" href="../migrate_ce_to_pro_with_docker/">
      
      
      <link rel="icon" href="../../media/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Setup with Kubernetes (K8s) - Seafile Admin Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deploy-seafile-cluster-with-kubernetes-k8s" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Seafile Admin Manual" class="md-header__button md-logo" aria-label="Seafile Admin Manual" data-md-component="logo">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Seafile Admin Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Setup with Kubernetes (K8s)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../setup_binary/outline_ce/" class="md-tabs__link">
          
  
  Setup (binary)

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../extension/setup_seadoc/" class="md-tabs__link">
          
  
  Extensions

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../config/ldap_in_11.0_ce/" class="md-tabs__link">
          
  
  Configuration

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../administration/" class="md-tabs__link">
          
  
  Administration

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../upgrade/upgrade/" class="md-tabs__link">
          
  
  Upgrade

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../develop/" class="md-tabs__link">
          
  
  Developing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../changelog/server-changelog/" class="md-tabs__link">
          
  
  ChangeLog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Seafile Admin Manual" class="md-nav__button md-logo" aria-label="Seafile Admin Manual" data-md-component="logo">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    Seafile Admin Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/file_permission_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File permission management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/contribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../caddy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPS and Caddy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Single node installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Single node installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_ce_by_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup community edition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_pro_by_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup pro edition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Advanced topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_1" >
        
          
          <label class="md-nav__link" for="__nav_2_4_1" id="__nav_2_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Storage Backends
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            Storage Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_with_s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S3 Backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_with_ceph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ceph Backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_with_swift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenStack Swift Backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_with_multiple_storage_backends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Storage Backends
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migrate_backends_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data migration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use_seasearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use SeaSearch as search engine (Pro)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k8s_single_node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup with Kubernetes (K8S, single pod mode)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seafile_docker_autostart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Docker autostart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_with_an_existing_mysql_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy with an existing MySQL server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use_other_reverse_proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use other reverse proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_seafile_as_non_root_user_inside_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Seafile as non root user inside docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cluster installation (Pro)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Cluster installation (Pro)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cluster_deploy_with_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Docker Cluster Deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Setup with Kubernetes (K8s)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Setup with Kubernetes (K8s)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      System requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-tools" class="md-nav__link">
    <span class="md-ellipsis">
      K8S tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-k8s-yaml-files-for-seafile-cluster-without-frontend-node" class="md-nav__link">
    <span class="md-ellipsis">
      Download K8S YAML files for Seafile cluster (without frontend node)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modify-seafile-envyaml-and-seafile-secretyaml" class="md-nav__link">
    <span class="md-ellipsis">
      Modify seafile-env.yaml and seafile-secret.yaml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-seafile-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize Seafile cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#put-the-license-into-optseafileshared" class="md-nav__link">
    <span class="md-ellipsis">
      Put the license into /opt/seafile/shared
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-frontend-services-yaml-and-restart-pods-to-start-seafile-server" class="md-nav__link">
    <span class="md-ellipsis">
      Download frontend service's YAML and restart pods to start Seafile server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-management" class="md-nav__link">
    <span class="md-ellipsis">
      Container management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-balance-and-https" class="md-nav__link">
    <span class="md-ellipsis">
      Load balance and HTTPS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-routing-and-aggregation-system" class="md-nav__link">
    <span class="md-ellipsis">
      Log routing and aggregation system
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Log routing and aggregation system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inputer" class="md-nav__link">
    <span class="md-ellipsis">
      Inputer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parser" class="md-nav__link">
    <span class="md-ellipsis">
      Parser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    <span class="md-ellipsis">
      Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-logs-to-loki" class="md-nav__link">
    <span class="md-ellipsis">
      Output log's to Loki
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Migration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Migration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migrate_ce_to_pro_with_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration from Seafile Community
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migrate_non_docker_to_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrate from non-docker deployment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setup (binary)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Setup (binary)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Seafile Community Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Seafile Community Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/outline_ce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/installation_ce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/https_with_nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPS with Nginx
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Seafile Professional Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Seafile Professional Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/outline_pro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/seafile_professional_sdition_software_license_agreement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/installation_pro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/cluster_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Deployment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other deployment notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Other deployment notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/start_seafile_at_system_bootup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start Seafile at System Bootup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/using_logrotate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logrotate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup_binary/migrate_from_sqlite_to_mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrate From SQLite to MySQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extensions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extra Seafile components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Extra Seafile components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/setup_seadoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SeaDoc Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/notification-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notification Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/webdav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebDAV extension
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/fuse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FUSE extension
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Online Office
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Online Office
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/libreoffice_online/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collabora Online Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/only_office/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OnlyOffice Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/office_web_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Office Online Server Integration (Pro)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cluster (Pro)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Cluster (Pro)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/distributed_indexing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed indexing
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Work in progress">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Virus Scan (Pro)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Virus Scan (Pro)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/virus_scan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/virus_scan_with_clamav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virus scan with ClamAV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extension/virus_scan_with_kav4fs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virus scan with Kav4fs
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Work in progress">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Authentication & Users
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Authentication & Users
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LDAP/AD Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            LDAP/AD Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ldap_in_11.0_ce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ldap_in_11.0_pro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP Integration (Pro)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Single Sign On
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            Single Sign On
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/single_sign_on/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/oauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/remote_user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote User Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/shibboleth_authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shibboleth Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/auto_login_seadrive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto Login to SeaDrive on Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/saml2_in_10.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAML 2.0 (Pro)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/auth_switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced User Management (Pro)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced User Management (Pro)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/multi_institutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Institutions Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/roles_permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roles and Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/admin_roles_permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Administrator Roles and Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/multi_tenancy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Tenancy Support
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/details_about_file_search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced File Search configuration (Pro)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ocm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open Cloud Mesh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Available configuration options
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Available configuration options
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/ccnet-conf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ccnet.conf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seafile-conf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    seafile.conf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seahub_settings_py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    seahub_settings.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seafevents-conf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    seafevents.conf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/seahub_customization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seahub customization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/sending_email/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Email Sending
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Administration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/two_factor_authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Two-factor Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/security_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/auditing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access logs and auditing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/export_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Export report
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/backup_recovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup and Recovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/seafile_fsck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile FSCK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/seafile_gc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile GC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../administration/clean_database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clean database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Upgrade
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Seafile Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_a_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Seafile Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_a_cluster_binary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Seafile Cluster (binary)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_7.1.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 7.1.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_8.0.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 8.0.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_9.0.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 9.0.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_10.0.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 10.0.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_11.0.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 11.0.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/upgrade_notes_for_12.0.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade notes for 12.0.x
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Developing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How to Build Seafile
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            How to Build Seafile
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/build_seafile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/osx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/rpi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server binary package
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/translation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Translation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/web_api_v2.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web API V2.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/rene-s/Seafile-PHP-SDK" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/data_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ChangeLog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            ChangeLog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/server-changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Community Edition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/changelog-for-seafile-professional-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Professional Edition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/client-changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seafile Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/drive-client-changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drive Client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      System requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-tools" class="md-nav__link">
    <span class="md-ellipsis">
      K8S tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-k8s-yaml-files-for-seafile-cluster-without-frontend-node" class="md-nav__link">
    <span class="md-ellipsis">
      Download K8S YAML files for Seafile cluster (without frontend node)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modify-seafile-envyaml-and-seafile-secretyaml" class="md-nav__link">
    <span class="md-ellipsis">
      Modify seafile-env.yaml and seafile-secret.yaml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-seafile-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize Seafile cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#put-the-license-into-optseafileshared" class="md-nav__link">
    <span class="md-ellipsis">
      Put the license into /opt/seafile/shared
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-frontend-services-yaml-and-restart-pods-to-start-seafile-server" class="md-nav__link">
    <span class="md-ellipsis">
      Download frontend service's YAML and restart pods to start Seafile server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-management" class="md-nav__link">
    <span class="md-ellipsis">
      Container management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-balance-and-https" class="md-nav__link">
    <span class="md-ellipsis">
      Load balance and HTTPS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-routing-and-aggregation-system" class="md-nav__link">
    <span class="md-ellipsis">
      Log routing and aggregation system
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Log routing and aggregation system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inputer" class="md-nav__link">
    <span class="md-ellipsis">
      Inputer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parser" class="md-nav__link">
    <span class="md-ellipsis">
      Parser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    <span class="md-ellipsis">
      Filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-logs-to-loki" class="md-nav__link">
    <span class="md-ellipsis">
      Output log's to Loki
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="deploy-seafile-cluster-with-kubernetes-k8s">Deploy Seafile cluster with Kubernetes (K8S)<a class="headerlink" href="#deploy-seafile-cluster-with-kubernetes-k8s" title="Permanent link">&para;</a></h1>
<p>This manual explains how to deploy and run Seafile cluster on a Linux server using <em>Kubernetes</em> (<strong><em>k8s</em></strong> thereafter). </p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<h3 id="system-requirements">System requirements<a class="headerlink" href="#system-requirements" title="Permanent link">&para;</a></h3>
<p>In theory, you only need to prepare one node to deploy a cluster, but this does not conform to the K8S design concept, so we recommend that you prepare at least 3 nodes ():</p>
<ul>
<li><strong>Two</strong> nodes for starting the Seafile frontend service</li>
<li><strong>One</strong> node for starting the Seafile backend service</li>
</ul>
<p>For each node, you have to prepare at least <strong>2 cores</strong> cpu, <strong>2G RAM</strong> and 10G disk space.</p>
<div class="admonition note">
<p class="admonition-title">More details about System requirements</p>
<p>We assume you have already deployed memory cache server (e.g., <strong><em>Memcached</em></strong>), <strong><em>MariaDB</em></strong>, file indexer (e.g., <strong><em>ElasticSearch</em></strong>) in separate machines and use <strong><em>S3</em></strong> like object storage. </p>
<ul>
<li>
<p>If some of the above services are deployed on one of the nodes, you may need to prepare more space for the node. Especially for <strong><em>ElasticSearch</em></strong>, you need to prepare at least <strong>4 cores</strong> cpu, <strong>4GB</strong> memory and more disk space on the node. If you donnot have enough hardware requirements for <em>ElasticSearch</em>, you can use <a href="../use_seasearch/"><em>SeaSearch</em></a> as search engine, which is more lightweight.</p>
</li>
<li>
<p>Generally, when deploying Seafile in a cluster, we recommend that you use a storage backend (such as AWS S3) to store Seafile data. However, according to the Seafile image startup rules and K8S persistent storage strategy, you still need to prepare a persistent directory for configuring the startup of the Seafile container. In this document, we use the following path for the persistent directory with maximum 10GB space:</p>
<div class="highlight"><pre><span></span><code>/opt/seafile/shared
</code></pre></div>
<p>If you would like to change it or increase the space, you should modify the <code>seafile-persistentvolume.yaml</code> and <code>seafile-persistentvolumeclaim.yaml</code> in this document.</p>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">More details about the number of nodes</p>
<ol>
<li>If your number of nodes does not meet our recommended number (i.e. 3 nodes), please adjust according to the following strategies:<ul>
<li><strong>2 nodes</strong>: A frontend service and a backend service on the same node</li>
<li><strong>1 node</strong>: Please refer <a href="../k8s_single_node/">here</a> to deploy Seafile in a K8S single node instead a cluster.</li>
</ul>
</li>
<li>If you have more available nodes for Seafile server, please provide them to the Seafile frontend service and <strong>make sure there is only one backend service running</strong>. Here is a simple relationship between the number of Seafile frontent services (<span class="arithmatex">\(N_f\)</span>) and total nodes (<span class="arithmatex">\(N_t\)</span>):
    $$
    N_f = N_t - 1,
    $$
    where the number <strong>1</strong> means one node for Seafile backend service.</li>
</ol>
</div>
<h3 id="k8s-tools">K8S tools<a class="headerlink" href="#k8s-tools" title="Permanent link">&para;</a></h3>
<p>Two tools are suggested and can be installed with <a href="https://kubernetes.io/docs/tasks/tools/">official installation guide</a> <strong>on all nodes</strong>:</p>
<ul>
<li><strong><em>kubectl</em></strong></li>
<li><strong><em>k8s control plane tool</em></strong> (e.g., <strong><em>kubeadm</em></strong>)</li>
</ul>
<p>After installation, you need to start the k8s control plane service on each node and refer to the k8s official manual for <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">creating a cluster</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Although we recommend installing the <em>k8s control plane tool</em> on each node, it does not mean that we will use each node as a control plane node, but it is a necessary tool to create or join a K8S cluster. For details, please refer to the above <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">link</a> about <strong>creating or joining into a cluster</strong>.</p>
</div>
<h2 id="download-k8s-yaml-files-for-seafile-cluster-without-frontend-node">Download K8S YAML files for Seafile cluster (without frontend node)<a class="headerlink" href="#download-k8s-yaml-files-for-seafile-cluster-without-frontend-node" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/opt/seafile-k8s-yaml

wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-backend-deployment.yaml
wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-persistentvolume.yaml
wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-persistentvolumeclaim.yaml
wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-service.yaml
wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-env.yaml
wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-secret.yaml
</code></pre></div>
<p>In here we suppose you download the YAML files in <code>/opt/seafile-k8s-yaml</code>, which mainly include about:</p>
<ul>
<li><code>seafile-xx-deployment.yaml</code> for frontend and backend services pod management and creation, </li>
<li><code>seafile-service.yaml</code> for exposing Seafile services to the external network, </li>
<li><code>seafile-persistentVolume.yaml</code> for defining the location of a volume used for persistent storage on the host</li>
<li><code>seafile-persistentvolumeclaim.yaml</code> for declaring the use of persistent storage in the container.</li>
</ul>
<p>For futher configuration details, you can refer <a href="https://kubernetes.io/docs/tasks/configure-pod-container/">the official documents</a>.</p>
<h2 id="modify-seafile-envyaml-and-seafile-secretyaml">Modify <code>seafile-env.yaml</code> and <code>seafile-secret.yaml</code><a class="headerlink" href="#modify-seafile-envyaml-and-seafile-secretyaml" title="Permanent link">&para;</a></h2>
<p>Similar to Docker-base deployment, Seafile cluster in K8S deployment also supports use files to configure startup progress, you can modify common <a href="../setup_pro_by_docker/#downloading-and-modifying-env">environment variables</a> by</p>
<div class="highlight"><pre><span></span><code>nano<span class="w"> </span>/opt/seafile-k8s-yaml/seafile-env.yaml
</code></pre></div>
<p>and sensitive information (e.g., password) by</p>
<div class="highlight"><pre><span></span><code>nano<span class="w"> </span>/opt/seafile-k8s-yaml/seafile-secret.yaml
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">For <code>seafile-secret.yaml</code></p>
<p>To modify sensitive information (e.g., password), you need to convert the password into base64 encoding before writing it into the <code>seafile-secret.yaml</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;&lt;your-value&gt;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the fields marked with <code>&lt;...&gt;</code> are <strong>required</strong>, please make sure these items are filled in, otherwise Seafile server may not run properly.</p>
</div>
<h2 id="initialize-seafile-cluster">Initialize Seafile cluster<a class="headerlink" href="#initialize-seafile-cluster" title="Permanent link">&para;</a></h2>
<p>You can use following command to initialize Seafile cluster now:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>/opt/seafile-k8s-yaml/
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">About Seafile cluster initialization</p>
<p>When Seafile cluster is initializing, it will run with the following conditions:</p>
<ul>
<li>Only have backend service (i.e., only has the Seafile backend K8S resouce file)</li>
<li><code>CLUSTER_INIT_MODE=true</code></li>
</ul>
</div>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>You can get the following information through <code>kubectl logs seafile-xxxx</code> (for details about this opeartions, please refer to <a href="#container-management">here</a>) to check the initialization process is done or not:</p>
<div class="highlight"><pre><span></span><code>---------------------------------
This is your configuration
---------------------------------

    server name:            seafile
    server ip/domain:       seafile.example.com

    seafile data dir:       /opt/seafile/seafile-data
    fileserver port:        8082

    database:               create new
    ccnet database:         ccnet_db
    seafile database:       seafile_db
    seahub database:        seahub_db
    database user:          seafile


Generating seafile configuration ...

done
Generating seahub configuration ...


-----------------------------------------------------------------
Your seafile server configuration has been finished successfully.
-----------------------------------------------------------------


[2024-11-21 02:22:37] Updating version stamp
Start init

Init success
</code></pre></div>
<p>When the initialization is complete, the server will stop automaticlly (because no operations will be performed after the initialization is completed). </p>
<p>We recommend that you check whether the contents of the configuration files in <code>/opt/seafile/shared/seafile/conf</code> are correct when going to next step, which are automatically generated during the initialization process.</p>
</div>
<h2 id="put-the-license-into-optseafileshared">Put the license into <code>/opt/seafile/shared</code><a class="headerlink" href="#put-the-license-into-optseafileshared" title="Permanent link">&para;</a></h2>
<p>You have to locate the <code>/opt/seafile/shared</code> directory generated during initialization firsly, then simply put it in this path, if you have a <code>seafile-license.txt</code> license file. </p>
<p>Finally you can use the <code>tar -zcvf</code> and <code>tar -zxvf</code> commands to package the entire <code>/opt/seafile/shared</code> directory of the current node, copy it to other nodes, and unpack it to the same directory to take effect on all nodes.</p>
<div class="admonition danger">
<p class="admonition-title">If the license file has a different name or cannot be read, Seafile server will start with in trailer mode with most THREE users</p>
</div>
<h2 id="download-frontend-services-yaml-and-restart-pods-to-start-seafile-server">Download frontend service's YAML and restart pods to start Seafile server<a class="headerlink" href="#download-frontend-services-yaml-and-restart-pods-to-start-seafile-server" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Download frontend service's YAML by:</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>-P<span class="w"> </span>/opt/seafile-k8s-yaml<span class="w"> </span>https://manual.seafile.com/12.0/repo/k8s/cluster/seafile-frontend-deployment.yaml
</code></pre></div>
</li>
<li>
<p>Modify <code>seafile-env.yaml</code>, and set <code>CLUSTER_INIT_MODE</code> to <code>false</code> (i.e., disable initialization mode)</p>
</li>
<li>
<p>Run the following command to restart pods to restart Seafile cluster:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you modify some configurations in <code>/opt/seafile/shared/seafile/conf</code> or YAML files in <code>/opt/seafile-k8s-yaml/</code>, you still need to restart services to make modifications.</p>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>delete<span class="w"> </span>-f<span class="w"> </span>/opt/seafile-k8s-yaml/
kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>/opt/seafile-k8s-yaml/
</code></pre></div>
</li>
</ol>
<div class="admonition sucess">
<p class="admonition-title">Sucess</p>
<p>You can <a href="#container-management">view the pod's log</a> to check the startup progress is normal or not. You can see the following message if server is running normally:</p>
<div class="highlight"><pre><span></span><code>*** Running /etc/my_init.d/01_create_data_links.sh...
*** Booting runit daemon...
*** Runit started as PID 20
*** Running /scripts/enterpoint.sh...
2024-11-21 03:02:35 Nginx ready 

2024-11-21 03:02:35 This is an idle script (infinite loop) to keep container running. 
---------------------------------

Seafile cluster frontend mode

---------------------------------


Starting seafile server, please wait ...
Seafile server started

Done.

Starting seahub at port 8000 ...

Seahub is started

Done.
</code></pre></div>
</div>
<h2 id="container-management">Container management<a class="headerlink" href="#container-management" title="Permanent link">&para;</a></h2>
<p>Similar to docker installation, you can also manage containers through <a href="https://kubernetes.io/docs/reference/kubectl/#operations">some kubectl commands</a>. For example, you can use the following command to check whether the relevant resources are started successfully and whether the relevant services can be accessed normally. First, execute the following command and remember the pod name with <code>seafile-&lt;node type&gt;-</code> as the prefix (such as <code>seafile-frontend-748b695648-d6l4g</code>)</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div>
<p>You can check a status of a pod by </p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>seafile-frontend-748b695648-d6l4g
</code></pre></div>
<p>and enter a container by</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>seafile-frontend-748b695648-d6l4g<span class="w"> </span>--<span class="w">  </span>bash
</code></pre></div>
<h2 id="load-balance-and-https">Load balance and HTTPS<a class="headerlink" href="#load-balance-and-https" title="Permanent link">&para;</a></h2>
<p>When deploying a Seafile cluster using K8S, you can enable HTTPS and use load balance in the following two ways:</p>
<ul>
<li>External load balancing server, such as <em>Nginx</em>. Typically you will need to reverse proxy <code>http://&lt;your control plane&gt;/</code></li>
<li>K8S Gateway API, e.g., <a href="https://docs.nginx.com/nginx-gateway-fabric/installation/installing-ngf/manifests/">Nginx-gateway</a> and <a href="https://istio.io/latest/docs/tasks/traffic-management/ingress/gateway-api/">Istio-gateway</a></li>
</ul>
<p>Finally, you should modify the related URLs in <code>seahub_settings.py</code>, from <code>http://</code> to <code>https://</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://seafile.example.com&quot;</span>
<span class="n">FILE_SERVER_ROOT</span> <span class="o">=</span> <span class="s1">&#39;https://seafile.example.com/seafhttp&#39;</span>
</code></pre></div>
<h2 id="log-routing-and-aggregation-system">Log routing and aggregation system<a class="headerlink" href="#log-routing-and-aggregation-system" title="Permanent link">&para;</a></h2>
<p>Similar to <a href="../k8s_single_node/">Single-pod Seafile</a>, you can browse the log files of Seafile running directly in the persistent volume directory. The difference is that when using K8S to deploy a Seafile cluster (especially in a cloud environment), the persistent volume created is usually shared and synchronized for all nodes. However, <strong><em>the logs generated by the Seafile service do not record the specific node information where these logs are located</em></strong>, so browsing the files in the above folder may make it difficult to identify which node these logs are generated from. Therefore, one solution proposed here is:</p>
<ol>
<li>
<p>Record the generated logs to the standard output. In this way, the logs can be distinguished under each node by <code>kubectl logs</code> (but all types of logs will be output together now). You can enable this feature (<strong>it should be enabled by default in K8S Seafile cluster but not in K8S single-pod Seafile</strong>) by modifing <code>SEAFILE_LOG_TO_STDOUT</code> to <code>true</code> in <code>seafile-env.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">SEAFILE_LOG_TO_STDOUT</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Then restart the Seafile server:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>delete<span class="w"> </span>-f<span class="w"> </span>/opt/seafile-k8s-yaml/
kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>/opt/seafile-k8s-yaml/
</code></pre></div>
</li>
<li>
<p>Since the logs in step 1 can be distinguished between nodes, but they are aggregated and output together, it is not convenient for log retrieval. So you have to route the standard output logs (i.e., distinguish logs by corresponding components name) and re-record them in a new file or upload them to a log aggregation system (e.g., <a href="https://grafana.com/oss/loki/"><em>Loki</em></a>).</p>
</li>
</ol>
<p>Currently in the K8S environment, the commonly used log routing plugins are:</p>
<ul>
<li><a href="https://fluentbit.io/"><em>Fluent Bit</em></a></li>
<li><a href="https://www.fluentd.org/"><em>Fluentd</em></a></li>
<li><a href="https://www.elastic.co/logstash/"><em>Logstash</em></a></li>
<li><a href="https://grafana.com/loki/docs/sources/promtail/"><em>Promtail</em></a> (also a part of Loki)</li>
</ul>
<p><strong><em>Fluent Bit</em></strong> and <strong><em>Promtail</em></strong> are more lightweight (i.e., consume less system resources), while <em>Promtail</em> only supports transferring logs to <em>Loki</em>. Therefore, this document will mainly introduce log routing through <strong><em>Fluent Bit</em></strong> which is a fast, lightweight logs and metrics agent. It is also a CNCF graduated sub-project under the umbrella of <em>Fluentd</em>. <em>Fluent Bit</em> is licensed under the terms of the Apache License v2.0. You should deploy the <em>Fluent Bit</em> in your K8S cluster by following <a href="https://docs.fluentbit.io/manual/installation/kubernetes">offical document</a> firstly. Then modify Fluent-Bit pod settings to mount a new directory to load the configuration files:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#kubectl edit ds fluent-bit</span>

<span class="nn">...</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">spec</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">containers</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fluent-bit</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">- mountPath</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/fluent-bit/etc/seafile</span>
<span class="w">              </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fluent-bit-seafile</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hostPath</span><span class="p">:</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/fluent-bit</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fluent-bit-seafile</span>
</code></pre></div>
<p>and</p>
<div class="highlight"><pre><span></span><code><span class="c1">#kubectl edit cm fluent-bit</span>

<span class="nt">data</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">fluent-bit.conf</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">[SERVICE]</span>
<span class="w">            </span><span class="no">...</span>
<span class="w">            </span><span class="no">Parsers_File /fluent-bit/etc/seafile/confs/parsers.conf</span>
<span class="w">        </span><span class="no">...</span>
<span class="w">        </span><span class="no">@INCLUDE /fluent-bit/etc/seafile/confs/*-log.conf</span>
</code></pre></div>
<p>For example in here, we use <code>/opt/fluent-bit/confs</code> (<strong>it has to be non-shared</strong>). What's more, the parsers will be defined in <code>/opt/fluent-bit/confs/parsers.conf</code>, and for each type log (e.g., <em>seahub</em>'s log, <em>seafevent</em>'s log) will be defined in <code>/opt/fluent-bit/confs/*-log.conf</code>. Each <code>.conf</code> file defines several Fluent-Bit data pipeline components:</p>
<table>
<thead>
<tr>
<th><strong>Pipeline</strong></th>
<th><strong>Description</strong></th>
<th><strong>Required/Optional</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>INPUT</strong></td>
<td>Specifies where and how Fluent-Bit can get the original log information, and assigns a tag for each log record after read.</td>
<td>Required</td>
</tr>
<tr>
<td><strong>PARSER</strong></td>
<td>Parse the read log records. For K8S Docker runtime logs, they are usually in Json format.</td>
<td>Required</td>
</tr>
<tr>
<td><strong>FILTER</strong></td>
<td>Filters and selects log records with a specified tag, and assigns a new tag to new records.</td>
<td>Optional</td>
</tr>
<tr>
<td><strong>OUTPUT</strong></td>
<td>tells Fluent-Bit what format the log records for the specified tag will be in and where to output them (such as file, <em>Elasticsearch</em>, <em>Loki</em>, etc.).</td>
<td>Required</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For <strong><em>PARSER</em></strong>, it can only be stored in <code>/opt/fluent-bit/confs/parsers.conf</code>, otherwise the Fluent-Bit cannot startup normally.</p>
</div>
<h3 id="inputer">Inputer<a class="headerlink" href="#inputer" title="Permanent link">&para;</a></h3>
<p>According to the above, a container will generate a log file (usually in <code>/var/log/containers/&lt;container-name&gt;-xxxxxx.log</code>), so you need to prepare an importer and add the following information (for more details, please refer to offical document about <a href="https://docs.fluentbit.io/manual/pipeline/inputs/tail"><em>TAIL inputer</em></a>) in <code>/opt/fluent-bit/confs/seafile-log.conf</code>:</p>
<div class="highlight"><pre><span></span><code>[INPUT]
    Name              tail
    Path              /var/log/containers/seafile-frontend-*.log
    Buffer_Chunk_Size 2MB
    Buffer_Max_Size   10MB
    Docker_Mode       On
    Docker_Mode_Flush 5
    Tag               seafile.*
    Parser            Docker # for definition, please see the next section as well

[INPUT]
    Name              tail
    Path              /var/log/containers/seafile-backend-*.log
    Buffer_Chunk_Size 2MB
    Buffer_Max_Size   10MB
    Docker_Mode       On
    Docker_Mode_Flush 5
    Tag               seafile.*
    Parser            Docker
</code></pre></div>
<p>The above defines two importers, which are used to monitor seafile-frontend and seafile-backend services respectively. The reason why they are written together here is that for a node, you may not know when it will run the frontend service and when it will run the backend service, but they have the same tag prefix <code>seafile.</code>.</p>
<h3 id="parser">Parser<a class="headerlink" href="#parser" title="Permanent link">&para;</a></h3>
<p>Each input has to use a parser to parse the logs and pass them to the filter. Here, a parser named <code>Docker</code> is created to parse the logs generated by the <em>K8S-docker-runtime container</em>. The parser is placed in <code>/opt/fluent-bit/confs/parser.conf</code> (for more details, please refer to offical document about <a href="https://docs.fluentbit.io/manual/pipeline/parsers/json">JSON parser</a>):</p>
<div class="highlight"><pre><span></span><code>[PARSER]
    Name        Docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Log records after parsing</p>
<p>The logs of the Docker container are saved in /var/log/containers in <strong>Json</strong> format (see the sample below), which is why we use the <code>Json</code> format in the above parser.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(86): fileserver: web_token_expire_time = 3600\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.294638442Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(98): fileserver: max_index_processing_threads= 3\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.294810145Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(111): fileserver: fixed_block_size = 8388608\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.294879777Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(123): fileserver: max_indexing_threads = 1\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.295002479Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(138): fileserver: put_head_commit_request_timeout = 10\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.295082733Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] seafile-session.c(150): fileserver: skip_block_hash = 0\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.295195843Z&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="nt">&quot;log&quot;</span><span class="p">:</span><span class="s2">&quot;[seaf-server] [2025-01-17 07:43:48] [INFO] ../common/seaf-utils.c(553): Use database Mysql\n&quot;</span><span class="p">,</span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="s2">&quot;2025-01-17T07:43:48.29704895Z&quot;</span><span class="p">}</span>
</code></pre></div>
<p>When these logs are obtained by the importer and parsed by the parser, they will become independent log records with the following fields:</p>
<ul>
<li><code>log</code>: The original log content (i.e., same as you seen in <code>kubectl logs seafile-xxx</code>) and an extra line break at the end (i.e., <code>\n</code>). <strong>This is also the field we need to save or upload to the log aggregation system in the end</strong>.</li>
<li><code>stream</code>: The original log come from. <code>stdout</code> means the <em>standard output</em>.</li>
<li><code>time</code>: The time when the log is recorded in the corresponding stream (ISO 8601 format).</li>
</ul>
</div>
<h3 id="filter">Filter<a class="headerlink" href="#filter" title="Permanent link">&para;</a></h3>
<p>Add two filters in <code>/opt/fluent-bit/confs/seafile-log.conf</code> for records filtering and routing. Here, the <a href="https://docs.fluentbit.io/manual/pipeline/filters/record-modifier"><em>record_modifier</em> filter</a> is to select useful keys (see the contents in above <em>tip</em> label, only the <code>log</code> field is what we need) in the log records and <a href="https://docs.fluentbit.io/manual/pipeline/filters/rewrite-tag"><em>rewrite_tag</em> filter</a> is used to route logs according to specific rules:</p>
<div class="highlight"><pre><span></span><code>[FILTER]        
    Name record_modifier
    Match seafile.*
    Allowlist_key log


[FILTER]
    Name        rewrite_tag
    Match       seafile.*
    Rule        $log ^.*\[seaf-server\].*$ seaf-server false # for seafile&#39;s logs
    Rule        $log ^.*\[seahub\].*$ seahub false # for seahub&#39;s logs
    Rule        $log ^.*\[seafevents\].*$ seafevents false # for seafevents&#39; lgos
    Rule        $log ^.*\[seafile-slow-rpc\].*$ seafile-slow-rpc false # for slow-rpc&#39;s logs
</code></pre></div>
<h3 id="output-logs-to-loki">Output log's to <em>Loki</em><a class="headerlink" href="#output-logs-to-loki" title="Permanent link">&para;</a></h3>
<p>Loki is multi-tenant log aggregation system inspired by <em>Prometheus</em>. It is designed to be very cost effective and easy to operate. The Fluent-Bit <em>loki</em> built-in output plugin allows you to send your log or events to a <em>Loki service</em>. It supports data enrichment with Kubernetes labels, custom label keys and Tenant ID within others.</p>
<div class="admonition tip">
<p class="admonition-title">Alternative Fluent-Bit Loki plugin by <em>Grafana</em></p>
<p>For sending logs to Loki, there are <a href="https://grafana.com/docs/loki/latest/send-data/fluentbit/">two plugins</a> for Fluent-Bit:</p>
<ul>
<li>The <a href="https://docs.fluentbit.io/manual/pipeline/outputs/loki">built-in <em>Loki</em> plugin</a> maintained by the Fluent-Bit officially, and we will use it in this part because it provides the most complete features.</li>
<li><a href="https://grafana.com/docs/loki/latest/send-data/fluentbit/community-plugin/"><em>Grafana-loki</em> plugin</a> maintained by <em>Grafana Labs</em>.</li>
</ul>
</div>
<p>Due to each outputer dose not have a distinguishing marks in the configuration files (because Fluent-Bit takes each plugin as a tag workflow): </p>
<ul>
<li>
<p><strong><em>Seaf-server log</em></strong>: Add an outputer to <code>/opt/fluent-bit/confs/seaf-server-log.conf</code>:</p>
<div class="highlight"><pre><span></span><code>[OUTPUT]
    Name        loki
    Match       seaf-server
    Host        &lt;your Loki&#39;s host&gt;
    port        &lt;your Loki&#39;s port&gt;
    labels      job=fluentbit, node_name=&lt;your-node-name&gt;, node_id=&lt;your-node-id&gt; # node_name and node_id is optional, but recommended for identifying the source node
</code></pre></div>
</li>
<li>
<p><strong><em>seahub log</em></strong>: Add an outputer to <code>/opt/fluent-bit/confs/seahub-log.conf</code>:</p>
<div class="highlight"><pre><span></span><code>[OUTPUT]
    Name        loki
    Match       seahub
    Host        &lt;your Loki&#39;s host&gt;
    port        &lt;your Loki&#39;s port&gt;
    labels      job=fluentbit, node_name=&lt;your-node-name&gt;, node_id=&lt;your-node-id&gt; # node_name and node_id is optional, but recommended for identifying the source node
</code></pre></div>
</li>
<li>
<p><strong><em>seafevents log</em></strong>: Add an outputer to <code>/opt/fluent-bit/confs/seafevents-log.conf</code>:</p>
<div class="highlight"><pre><span></span><code>[OUTPUT]
    Name        loki
    Match       seafevents
    Host        &lt;your Loki&#39;s host&gt;
    port        &lt;your Loki&#39;s port&gt;
    labels      job=fluentbit, node_name=&lt;your-node-name&gt;, node_id=&lt;your-node-id&gt; # node_name and node_id is optional, but recommended for identifying the source node
</code></pre></div>
</li>
<li>
<p><strong><em>seafile-slow-rpc log</em></strong>: Add an outputer to <code>/opt/fluent-bit/confs/seafile-slow-rpc-log.conf</code>:</p>
<div class="highlight"><pre><span></span><code>[OUTPUT]
    Name        loki
    Match       seafile-slow-rpc
    Host        &lt;your Loki&#39;s host&gt;
    port        &lt;your Loki&#39;s port&gt;
    labels      job=fluentbit, node_name=&lt;your-node-name&gt;, node_id=&lt;your-node-id&gt; # node_name and node_id is optional, but recommended for identifying the source node
</code></pre></div>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Cloud Loki instance</p>
<p>If you are using a cloud Loki instance, you can follow the <a href="https://docs.fluentbit.io/manual/pipeline/outputs/loki">Fluent-Bit Loki plugin document</a> to fill up all necessary fields. Usually, the following fields are <strong>additional needs</strong> in cloud Loki service:</p>
<ul>
<li><code>tls</code></li>
<li><code>tls.verify</code></li>
<li><code>http_user</code></li>
<li><code>http_passwd</code></li>
</ul>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../cluster_deploy_with_docker/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Seafile Docker Cluster Deployment">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Seafile Docker Cluster Deployment
              </div>
            </div>
          </a>
        
        
          
          <a href="../migrate_ce_to_pro_with_docker/" class="md-footer__link md-footer__link--next" aria-label="Next: Migration from Seafile Community">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Migration from Seafile Community
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Seafile Ltd.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/haiwen/seafile-admin-docs/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.tracking", "navigation.sections", "navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "search.share", "math"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>